import numpy as np

old2world = np.array([
    [0.091979, 0.040193, -0.202176, 0.771204],
    [0.205922, -0.007912, 0.09211, -0.335536],
    [0.009315, -0.221975, -0.039892, 0.520633],
    [0, 0, 0, 1]
])
new2old = np.array([
    [0.001506, 0.909799, 0.415046, -0.960789],
    [0.980595, -0.082709, 0.177742, -1.120567],
    [0.196038, 0.406724, -0.892269, 10.431368],
    [0, 0, 0, 1]
])

scale_factor = np.eye(4) * 0.45
scale_factor[3, 3] = 1.0  # Keep the homogeneous coordinate unchanged

"""
    - [0.4530907442, -0.1138074980, 0.1826615014, -1.4464470745]
    - [0.1565323476, -0.1179127747, -0.4617398912, -1.3698122690]
    - [0.1477003749, 0.4740826232, -0.0709911599, 9.4519832706]
    - [0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000]
"""
"""
Reformat the above

0.45309077442 -0.1138074980 0.1826615014 -1.4464470745
0.1565323476 -0.1179127747 -0.4617398912 -1.3698122690
0.1477003749 0.4740826232 -0.0709911599 9.4519832706
0.00000000000 0.00000000 0.00000000 1.000000
"""


result = old2world @ scale_factor @ np.linalg.inv(new2old)
for row in result:
    print(f"- [{', '.join(f'{val:.10f}' for val in row)}]")

print()

for row in result:
    print(" ".join(f"{val:.10f}" for val in row))


"""
0.004857 0.005595 0.071124 -0.161531
0.004650 0.071112 -0.005912 -0.013337
-0.071192 0.005026 0.004467 0.393578
0.000000 0.000000 0.000000 1.000000
"""
"""
reformat the above
- 0.004857, 0.005595, 0.071124, -0.161531
- 0.004650, 0.071112, -0.005912, -0.013337
- -0.071192, 0.005026, 0.004467, 0.393578
- 0.000000, 0.000000, 0.000000, 1.000000


"""